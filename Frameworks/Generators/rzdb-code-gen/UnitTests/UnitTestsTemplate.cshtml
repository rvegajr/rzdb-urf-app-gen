@using System.Collections.Generic
@using RzDb.CodeGen
@{ SchemaData _Model = (SchemaData)Model; }

@foreach (string entityName in _Model.Keys){<t>##FILE=$OUTPUT_PATH$@entityName<t/>CoreTests.cs
//------------------------------------------------------------------------------
// <auto-generated>
    //     This code was generated from a template.
    //
    //     Manual changes to this file may cause unexpected behavior in your application.
    //     Manual changes to this file will be overwritten if the code is regenerated.
    //
//  </auto-generated>
//------------------------------------------------------------------------------
using Microsoft.VisualStudio.TestTools.UnitTesting;
using System.Net.Http;
using System.Threading.Tasks;
using System.Net;

namespace Tests.RouteTests
{
    [TestClass]
    public class @entityName<t/>CoreTests : WebApiTestBaseClass
    {
        [TestMethod]
        public async Task @entityName<t/>GetShouldReturnHTTPOk()
        {
            using (var response = await HttpClient.GetAsync("http://testserver/api/@entityName<t/>?%24top=10"))
            {
                var result = await response.Content.ReadAsStringAsync();
                Assert.IsTrue(response.StatusCode == HttpStatusCode.OK, "Return Get 10 or less for @entityName<t/>");
            }
</t>
    List<string> PreviousManyToOneFields = new List<string>();
    List<Relationship> RelationshipsManyToOne = _Model[entityName].Relationships.Fetch(RelationshipType.ManyToZeroOrOne);
    foreach (Relationship relationship in RelationshipsManyToOne)
    {
            string ExpandColumnName = ((Relationships.CountItems(RelationshipsManyToOne, RelationSearchField.FromTableName, relationship.FromTableName) > 1) ? relationship.ToColumnName : relationship.FromTableName.ToSingular());<t>
            using (var response = await HttpClient.GetAsync("http://testserver/api/@entityName<t/>?%24expand=@ExpandColumnName<t/>&%24top=10"))
            {
                var result = await response.Content.ReadAsStringAsync();
                Assert.IsTrue(response.StatusCode == HttpStatusCode.OK, "Return Get 10 or less @entityName with Expand of @ExpandColumnName");
            }</t>
            PreviousManyToOneFields.Add(relationship.FromTableName);
    }
<t> 
        }
    }
}
</t>}